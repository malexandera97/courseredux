<ActionBar title="Buscar Productos" class="action-bar"></ActionBar>

<StackLayout class="page">
    <!-- Requisito: Formulario de bÃºsquedas (caja de texto y botÃ³n) para filtrado -->
    <StackLayout class="search-container">
        <Label text="Buscar productos:" class="search-label"></Label>
        <FlexboxLayout flexDirection="row" alignItems="center" class="search-form">
            <TextField 
                [(ngModel)]="searchQuery" 
                hint="Buscar por nombre o descripciÃ³n"
                class="search-input"
                flex="1">
            </TextField>
            <Button 
                text="ðŸ” Buscar" 
                (tap)="onSearch()" 
                class="btn btn-primary search-button"
                [isEnabled]="!isSearching">
            </Button>
        </FlexboxLayout>
        <Button 
            text="âœ– Limpiar" 
            (tap)="onClearSearch()" 
            class="btn btn-secondary clear-button">
        </Button>
    </StackLayout>

    <!-- Requisito 2: ListView con plantilla anidada con FlexboxLayout -->
    <!-- Requisito 4: Pull to refresh -->
    <ListView 
        [items]="products" 
        (itemTap)="onItemTap($event)"
        (pullToRefreshInitiated)="onPullToRefresh($event)"
        class="list-group"
        separatorColor="transparent">
        <ng-template let-product="item">
            <!-- FlexboxLayout anidado -->
            <FlexboxLayout class="product-item" flexDirection="row" justifyContent="space-between" alignItems="center">
                <FlexboxLayout flexDirection="column" class="product-info" flex="1">
                    <Label [text]="product.name" class="product-name"></Label>
                    <Label [text]="product.description" class="product-description" textWrap="true"></Label>
                    <FlexboxLayout flexDirection="row" justifyContent="space-between" class="product-meta">
                        <Label [text]="'$' + product.price" class="product-price"></Label>
                        <Label [text]="product.category" class="product-category"></Label>
                    </FlexboxLayout>
                </FlexboxLayout>
                
                <!-- Requisito: Ãcono para guardar como favorito -->
                <FlexboxLayout flexDirection="row" alignItems="center">
                    <Button 
                        [text]="isFavorite(product.id) ? 'â­' : 'â˜†'" 
                        (tap)="onToggleFavorite(product)" 
                        class="btn-favorite">
                    </Button>
                    <Label text="â€º" class="chevron"></Label>
                </FlexboxLayout>
            </FlexboxLayout>
        </ng-template>
    </ListView>
</StackLayout>
